resources
| where type == "microsoft.sql/servers"
| project id, name, resourceGroup, subscriptionId
| join kind=leftouter (
    resources
    | where type == "microsoft.sql/servers/azureadonlyauthentications"
    | project serverId = tolower(id), azureAdOnlyAuthentication = tobool(properties.azureAdOnlyAuthentication)
) on $left.id == $right.serverId
| extend aadOnlyEnabled = case(isnotempty(azureAdOnlyAuthentication), azureAdOnlyAuthentication, false)
| where aadOnlyEnabled == false
| project 
    ServerName = name,
    ResourceGroup = resourceGroup,
    SubscriptionId = subscriptionId,
    AADOnlyEnabled = aadOnlyEnabled
